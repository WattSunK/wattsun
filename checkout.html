cat > checkout.html << 'EOF'
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Checkout - WattSun</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link href="css/main.css" rel="stylesheet"/>
</head>
<body>
  <div class="container">
    <h2>Checkout</h2>
    <div class="total" id="totalAmount">Total Deposit: KES 0</div>
    <form id="checkoutForm">
      <input type="hidden" id="cart_summary" name="cart_summary"/>
      <label for="fullName">Full Name</label>
      <input id="fullName" name="fullName" required type="text"/>
      <label for="email">Email Address</label>
      <input id="email" name="email" required type="email"/>
      <label for="phone">Phone Number</label>
      <input id="phone" name="phone" required type="tel"/>
      <label for="address">Delivery Address</label>
      <textarea id="address" name="address" required rows="3"></textarea>
      <div class="checkout-actions">
        <a class="loan-btn secondary" href="shop.html">← Back to Shop</a>
        <button class="btn" type="submit">Place Order →</button>
      </div>
    </form>
    <div id="confirmationMessage" style="display:none; margin-top: 20px;"></div>
  </div>

  <script>
  document.addEventListener("DOMContentLoaded", function () {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const summaryInput = document.getElementById("cart_summary");
    const totalEl = document.getElementById("totalAmount");
    const confirmMsg = document.getElementById("confirmationMessage");
    let totalDeposit = 0;
    const summary = [];

    cart.forEach(function(item) {
      const qty = item.quantity || 1;
      const deposit = Math.round(item.price * 0.5);
      totalDeposit += deposit * qty;
      summary.push(item.name + " (x" + qty + ") - Deposit: KES " + deposit);
    });

    summaryInput.value = summary.join("\\n");
    totalEl.textContent = "Total Deposit: KES " + totalDeposit.toLocaleString();

    const form = document.getElementById("checkoutForm");
    form.addEventListener("submit", async function(e) {
      e.preventDefault();
      confirmMsg.style.display = "block";
      confirmMsg.style.color = "blue";
      confirmMsg.textContent = "⏳ Sending order...";

      const formData = {
        fullName: form.fullName.value,
        email: form.email.value,
        phone: form.phone.value,
        address: form.address.value,
        cart_summary: summaryInput.value
      };

      try {
        const res = await fetch("https://api.wattsun.co.ke/api/checkout", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(formData)
        });

        if (res.ok) {
          confirmMsg.style.color = "green";
          confirmMsg.textContent = "✅ Order placed successfully!";
          localStorage.removeItem("cart");
          form.reset();
          setTimeout(function () {
            window.location.href = "thankyou.html";
          }, 2000);
        } else {
          confirmMsg.style.color = "red";
          confirmMsg.textContent = "❌ Server error (" + res.status + ")";
        }
      } catch (err) {
        confirmMsg.style.color = "red";
        confirmMsg.textContent = "❌ Network error. Could not connect to server.";
      }
    });
  });
  </script>
</body>
</html>
