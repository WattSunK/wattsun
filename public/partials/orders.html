<section class="card" id="ordersSection">
  <div class="card-header card-header--tight">
    <h2 class="h2">Orders</h2>
    <div class="spacer"></div>
    <button id="btnAddOrder_orders" class="btn btn-primary" type="button">Add Order</button>
  </div>

  <!-- Filters -->
  <div class="filters-bar" id="ordersFilters">
    <div class="group">
      <label>Order Type</label>
      <select id="ordersStatus" class="input" aria-label="Order Type">
        <option value="">All types</option>
        <option>Pending</option>
        <option>Processing</option>
        <option>Confirmed</option>
        <option>Dispatched</option>
        <option>Delivered</option>
        <option>Closed</option>
        <option>Cancelled</option>
      </select>
    </div>

    <div class="group">
      <label>From</label>
      <input id="ordersFrom" class="input" type="date" placeholder="dd/mm/yyyy" aria-label="From date" />
    </div>

    <div class="group">
      <label>To</label>
      <input id="ordersTo" class="input" type="date" placeholder="dd/mm/yyyy" aria-label="To date" />
    </div>

    <div class="group grow">
      <label>Search</label>
      <input id="ordersSearch" class="input" type="search" placeholder="Find orderâ€¦" aria-label="Search orders" />
    </div>

    <div class="group">
      <label>&nbsp;</label>
      <div class="row">
        <button id="ordersSearchBtn" class="btn" type="button">Search</button>
        <button id="ordersClearBtn" class="btn" type="button">Clear</button>
      </div>
    </div>
  </div>

  <!-- Table -->
  <div class="table-wrap">
    <table id="ordersTable" class="table" data-role="orders-table">
      <thead>
        <tr>
          <th>Order #</th>
          <th>Customer</th>
          <th>Phone</th>
          <th>Status</th>
          <th>Created</th>
          <th>Total</th>
          <th>Deposit</th>
          <th style="text-align:center;">Action</th>
        </tr>
      </thead>
      <tbody id="ordersTbody">
        <tr><td colspan="8" class="muted">(No data yet)</td></tr>
      </tbody>
    </table>
  </div>

  <!-- Pager / Meta -->
  <div class="filters-bar">
    <div id="ordersMeta" class="group">Showing 0 of 0 entries</div>
    <div class="spacer"></div>
    <div class="pager" id="ordersPager">
      <div class="per">
        <label for="ordersPer">Per page</label>
        <select id="ordersPer" class="input" aria-label="Per page">
          <option value="5">5</option>
          <option value="10" selected>10</option>
          <option value="20">20</option>
        </select>
      </div>
      <button class="btn" id="ordersFirst" type="button">First</button>
      <button class="btn" id="ordersPrev" type="button">Previous</button>
      <span class="page-indicator" id="ordersPageNum">Page 1 / 1</span>
      <button class="btn" id="ordersNext" type="button">Next</button>
      <button class="btn" id="ordersLast" type="button">Last</button>
    </div>
  </div>
</section>

<script>
(function () {
  document.getElementById('btnAddOrder_orders')?.addEventListener('click', () => {
    window.dispatchEvent(new CustomEvent('admin:create', {
      detail: { type: 'order', source: 'orders' }
    }));
  });

  // Notify the shell a partial loaded
  window.dispatchEvent(new CustomEvent('admin:partial-loaded', {
    detail: { partial: 'orders', section: document.getElementById('ordersSection') }
  }));

  // Boot the canonical controller once it is ready
  const tryBoot = () => {
    if (typeof window.__WS_ORDERS_FORCE_BOOT === 'function') {
      try { window.__WS_ORDERS_FORCE_BOOT(); } catch (_) {}
    } else {
      setTimeout(tryBoot, 100);
    }
  };
  tryBoot();

  document.addEventListener('visibilitychange', () => {
    if (document.visibilityState === 'visible') {
      setTimeout(() => window.__WS_ORDERS_FORCE_BOOT?.(), 0);
    }
  });

  window.addEventListener('focus', () => {
    setTimeout(() => window.__WS_ORDERS_FORCE_BOOT?.(), 0);
  });
})();
</script>
<script>
(function () {
  function refresh() {
    if (typeof window.__WS_ORDERS_FORCE_BOOT === "function") {
      window.__WS_ORDERS_FORCE_BOOT();
    }
  }
  window.addEventListener("orders:reload", refresh);
  window.addEventListener("message", function (e) {
    if (e && e.data && e.data.type === "orders-updated") refresh();
  });
})();
</script>
<!-- End of file: public/partials/orders.html -->

