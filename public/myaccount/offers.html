<!-- public/myaccount/offers.html -->
<div class="ws-toolbar" style="display:flex;justify-content:flex-end;gap:10px;margin:10px 0;">
  <button id="wsHome" class="ws-btn ws-btn-outline" style="padding:8px 14px;border-radius:8px;">Return to Home</button>
  <button id="wsLogout" class="ws-btn ws-btn-yellow" style="padding:8px 14px;border-radius:8px;">Logout</button>
</div>

<!-- Loyalty – matches reference layout -->
<section class="ws-loyalty">
  <h2 class="ws-title">Staff Loyalty</h2>

  <!-- Summary Card -->
  <div class="ws-card" id="accountCard">
    <div style="display:flex;flex-wrap:wrap;gap:12px;">
      <div style="flex:1 1 260px;min-width:260px;">
        <h3 style="margin:4px 0 8px;">Balance</h3>
        <div style="font-size:28px;font-weight:700;"><span id="pointsBalance">—</span> pts</div>
        <div class="muted" id="eurBalance">€—</div>
      </div>

      <div style="flex:1 1 260px;min-width:260px;">
        <h3 style="margin:4px 0 8px;">Status</h3>
        <div><span id="statusTag" class="pill">—</span></div>
        <div class="muted" id="dateInfo" style="margin-top:6px;">Start — / Eligible — / End —</div>
      </div>

      <div style="flex:1 1 260px;min-width:260px;">
        <h3 style="margin:4px 0 8px;">Actions</h3>
        <div class="muted" id="minInfo">Minimum withdrawal: — pts</div>
        <div style="margin-top:8px;">
          <button id="enrollBtn" class="ws-btn ws-btn-yellow">Enroll</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Withdraw Card -->
  <div class="ws-card" id="withdrawCard" style="display:none;">
    <h3 style="margin:4px 0 12px;">Withdraw</h3>
    <p class="muted" id="withdrawHelp" style="margin:0 0 10px;">You can withdraw points (min shown above) at €1/pt.</p>

    <div style="display:flex;flex-wrap:wrap;gap:12px;align-items:flex-end;">
      <div style="min-width:220px;">
        <label class="muted" for="withdrawPoints">Points to withdraw</label><br/>
        <input id="withdrawPoints" class="ws-input" type="number" min="100" step="1" value="100" style="width:220px;" />
      </div>

      <div style="min-width:180px;">
        <div class="muted">Estimated payout</div>
        <div style="font-size:22px;font-weight:700;" id="estimateEUR">€100</div>
      </div>

      <div style="min-width:200px;">
        <button id="withdrawBtn" class="ws-btn ws-btn-yellow" disabled>Request Withdrawal</button>
      </div>
    </div>

    <div id="withdrawMsg" class="muted" style="margin-top:8px;"></div>
  </div>

  <!-- History Card -->
  <div class="ws-card" id="historyCard" style="display:none;">
    <h3 style="margin:4px 0 12px;">Withdrawal Requests</h3>
    <table class="ws-table" id="historyTable">
      <thead>
        <tr>
          <th>ID</th>
          <th>Requested</th>
          <th>Status</th>
          <th>Requested At</th>
          <th>Decided</th>
          <th>Paid</th>
          <th>Reference</th>
        </tr>
      </thead>
      <tbody id="historyBody"><tr><td colspan="7">No withdrawals yet.</td></tr></tbody>
    </table>
  </div>
</section>

<link rel="stylesheet" href="/main.css"/>

<style>
  /* reuse same local helpers from myorders.html */
  .ws-loyalty{ max-width:1180px; }
  .ws-title{ margin:6px 0 12px; font-size:22px; }
  .ws-card{ background:#fff; border:1px solid #f0e6bf; border-radius:10px; box-shadow:0 8px 18px rgba(0,0,0,.05); padding:10px; margin-bottom:12px; }
  .ws-table{ width:100%; border-collapse:separate; border-spacing:0; }
  .ws-table thead th{ text-align:left; font-weight:700; font-size:13px; padding:12px; background:#fffdf3; border-bottom:1px solid #f0e6bf; }
  .ws-table tbody td{ padding:12px; border-bottom:1px solid #f5f5f5; font-size:14px; vertical-align:top; }
  .ws-input{ padding:8px 10px; border-radius:8px; border:1px solid #e5e5e5; background:#fff; font-size:14px; outline:none; }
  .ws-input:focus{ box-shadow:0 0 0 3px rgba(255,229,143,.5); border-color:#ffd666; }
  .ws-btn{ appearance:none; border:none; border-radius:8px; padding:8px 14px; font-weight:600; cursor:pointer; }
  .ws-btn-yellow{ background:#f0c419; }
  .ws-btn-outline{ background:#fff; border:1px solid #d9d9d9; }
  .muted{ color:#555; font-size:13px; }
  .pill{ display:inline-block; padding:3px 8px; border-radius:999px; border:1px solid #d9d9d9; background:#fff; font-size:12px; }
</style>

<script defer src="/js/auth.js"></script>
<script defer src="/js/loyalty-offers.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    var h=document.getElementById('wsHome'); var l=document.getElementById('wsLogout');
    if(h) h.addEventListener('click', ()=>{ window.location.href='/index.html'; });
    if(l) l.addEventListener('click', ()=>{ try{localStorage.removeItem('wattsunUser');}catch(e){} try{localStorage.removeItem('ws_user');}catch(e){} window.location.href='/index.html'; });
    // loyalty-offers.js auto-inits; call here only if you wrap it in a named init
    if (typeof initLoyaltyOffers === 'function') initLoyaltyOffers();
  });
</script>
