<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Thank You – WattSun Solar</title>
  <link rel="stylesheet" href="main.css" />
  <style>
    html, body { height: 100%; margin: 0; padding: 0; }
    body {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      font-family: "Segoe UI", Arial, sans-serif;
      background: #f9f8ec;
    }
    .page-content { flex: 1 0 auto; }
    footer { flex-shrink: 0; }

    .container {
      max-width: 420px;
      margin: 64px auto 34px;
      background: #fffdfa;
      padding: 38px 20px 44px;
      border-radius: 16px;
      box-shadow: 0 8px 24px #e5c75e33;
      text-align: center;
    }
    h1 { color: #ad890b; margin: 0 0 15px; }
    p  { color: #4a3d06; font-size: 1.08rem; margin: 0 0 10px; }

    .info-block {
      margin: 22px 0 20px;
      background: #fffbe8;
      border-radius: 10px;
      padding: 16px 12px;
      box-shadow: 0 2px 12px #e5c75e20;
      font-size: 1.02rem;
      display: none; /* shown by JS */
    }
    .label { font-weight: 700; color: #b47d08; }

    .button {
      display: inline-block;
      background: linear-gradient(90deg,#f7b733 0%,#fcf6ba 100%);
      color: #965700;
      font-weight: 700;
      text-decoration: none;
      padding: 12px 32px;
      border-radius: 10px;
      margin-top: 16px;
      box-shadow: 0 2px 10px #f7b73333;
      font-size: 1.05rem;
      border: 0;
      transition: filter .12s ease;
    }
    .button:hover { filter: brightness(1.03); }
    .button:active { filter: brightness(.98); }

    @media (max-width: 540px) {
      .container { margin: 14vw 2vw 8vw; max-width: 98vw; padding: 24px 3vw 28px; }
      h1 { font-size: 1.35rem; }
      .button { font-size: 1rem; padding: 11px 4vw; }
    }

    footer {
      margin-top: 48px;
      width: 100%;
      background: linear-gradient(90deg,#f7b733 0%,#fcf6ba 100%);
      color: #6b5100;
      text-align: center;
      font-size: 1.05rem;
      padding: 18px 0 6px;
      letter-spacing: .01em;
    }
    .footer-contacts a { color: #6b5100; text-decoration: underline; }
    .footer-contacts a:hover { color: #a58512; }
  </style>
</head>
<body>
<header>
  <div class="header-bar">
    <h1 class="desktop-logo">
      <img src="assets/logo/Wattsun Solar log2.png" alt="WattSun Solar Logo"
           style="width:60px; object-fit:contain; margin-right:10px;" />
      WattSun Solar
    </h1>
    <div class="logo-container">
      <img class="site-logo" src="assets/logo/Wattsun Solar log2.png" alt="WattSun Solar Logo" />
      <span class="brand-name">WattSun Solar</span>
    </div>
    <button class="nav-toggle" aria-label="Open menu" onclick="toggleNav()">â˜°</button>
  </div>
  <nav id="mainNav">
    <a href="index.html">Home</a>
    <a href="solutions.html">Solutions</a>
    <a href="shop.html">Shop</a>
    <a href="financing.html">Financing</a>
    <a href="projects.html">Projects</a>
    <a href="contact.html">Contact</a>
    <a class="cart-icon-link" href="cart.html" aria-label="View shopping cart" title="View cart">
      <span class="cart-icon" aria-hidden="true"></span></span>
    </a>
  </nav>
</header>

<div class="page-content">
  <div class="container">
    <h1>Thank You!</h1>

    <div id="order-info" class="info-block">
      <div><span class="label">Order Number:</span> <span id="orderNum">-</span></div>
      <div><span class="label">Customer Name:</span> <span id="custName">-</span></div>
    </div>

    <p>Your order has been received.</p>
    <p>We'll contact you soon to confirm details and arrange delivery.</p>
    <p>For urgent questions, email <a href="mailto:info@wattsun.co.ke">info@wattsun.co.ke</a>.</p>

    <a class="button" href="index.html">Return to Home</a>
  </div>
</div>

<script>
  function toggleNav() {
    var nav = document.getElementById("mainNav");
    nav.classList.toggle("active");
  }
  window.addEventListener("resize", function () {
    if (window.innerWidth > 800) {
      document.getElementById("mainNav").classList.remove("active");
    }
  });

  // Read user helper: supports {success:true,user:{...}} or plain object in localStorage
  function readWattsunUser() {
    try {
      const raw = localStorage.getItem("wattsunUser");
      if (!raw) return null;
      const parsed = JSON.parse(raw);
      return parsed && typeof parsed === "object"
        ? (parsed.success ? parsed.user : parsed)
        : null;
    } catch { return null; }
  }

  // Get order number from URL (?order= or ?orderNumber=), then sessionStorage, then nothing.
  function getOrderNumber() {
    const sp = new URLSearchParams(location.search);
    const fromUrl = sp.get("order") || sp.get("orderNumber");
    const fromHash = (location.hash || "").replace(/^#/, "");
    const fromSession = sessionStorage.getItem("orderNumber");
    return (fromUrl && fromUrl.trim())
        || (fromHash.startsWith("order=") ? fromHash.slice(6) : "")
        || (fromSession && fromSession.trim())
        || "";
  }

  // Get customer name from sessionStorage or logged-in user
  function getCustomerName() {
    const n1 = sessionStorage.getItem("customerName");
    if (n1 && n1.trim()) return n1.trim();
    const u = readWattsunUser();
    return (u && (u.name || u.fullName || u.username)) || "";
  }

  // Render
  (function init() {
    const orderNum = getOrderNumber();
    const custName = getCustomerName();

    // Always show the block; fill dashes if missing
    document.getElementById("order-info").style.display = "block";
    document.getElementById("orderNum").textContent = orderNum || "-";
    document.getElementById("custName").textContent = custName || "-";

    // Clean up transient keys
    sessionStorage.removeItem("orderNumber");
    sessionStorage.removeItem("customerName");

    // Cart is done—clear it
    localStorage.removeItem("cart");
  })();
</script>

<footer style="margin-top:48px;width:100%;background:linear-gradient(90deg,#f7b733 0%,#fcf6ba 100%);color:#6b5100;text-align:center;font-size:1.05rem;padding:16px 0 6px;letter-spacing:.01em;"><div class="footer-contacts"><a href="mailto:info@wattsun.co.ke" style="color:#6b5100;text-decoration:underline;">info@wattsun.co.ke</a></div><p>© 2025 WattSun Solar. All rights reserved.</p></footer>
  <script defer src="/js/auth.js"></script>
  </body>
</html>

